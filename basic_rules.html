<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ã‚³ãƒ¼ã‚¹ãƒ‡ãƒ“ãƒ¥ãƒ¼ã€Œã„ã‚ã¯ã€ | 3ã‚¿ãƒƒãƒ—ãƒ«ãƒ¼ãƒ«ã‚º</title>
  <link rel="stylesheet" href="style.css" />

  <style>
    body {
      font-family: "Helvetica", "Arial", sans-serif;
      background: #f9fff9;
      margin: 0;
      padding-bottom: 80px; /* ä¸‹éƒ¨ãƒŠãƒ“åˆ† */
    }

    /* âœ… ãƒ˜ãƒƒãƒ€ãƒ¼ï¼šçµ±ä¸€ãƒ‡ã‚¶ã‚¤ãƒ³ */
    header {
      background: #00bfa5;
      color: #fff;
      text-align: center;
      padding: 16px 0;
      font-size: 24px;
      font-weight: bold;
      border-bottom-left-radius: 28px;
      border-bottom-right-radius: 28px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.10);
    }
    header img {
      height: 26px;
      vertical-align: -5px;
      margin-right: 8px;
    }

    /* âœ… ã‚µãƒ–èª¬æ˜ï¼ˆåˆå¿ƒè€…å‘ã‘ï¼‰ */
    .intro {
      width: 92%;
      max-width: 560px;
      margin: 14px auto 10px;
      background: #ffffff;
      border-radius: 18px;
      padding: 12px 14px;
      color: #333;
      box-shadow: 0 2px 10px rgba(0,0,0,0.06);
      line-height: 1.5;
      font-size: 14px;
    }

    /* âœ… ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ */
    #basicRulesList {
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    /* âœ… ä¸€è¦§ã‚¢ã‚¤ãƒ†ãƒ ï¼ˆãƒœã‚¿ãƒ³é¢¨ï¼‰ */
    .rule-item {
      display: block;
      width: 90%;
      max-width: 500px;
      margin: 10px auto;
      padding: 14px 0;
      text-align: center;
      background: #fff;
      color: #333;
      border-radius: 25px;
      font-size: 16px;
      font-weight: 600;
      text-decoration: none;
      border: none;
      cursor: pointer;
      transition: 0.2s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.10);
    }
    .rule-item:hover {
      transform: translateY(-2px);
    }

    .empty {
      text-align: center;
      color: #777;
      padding: 18px 0;
    }

    /* âœ… ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹ãƒœã‚¿ãƒ³ï¼šé»„è‰² */
    .back-btn {
      display: block;
      width: 220px;
      text-align: center;
      background: #FFD84D;
      color: #333;
      text-decoration: none;
      margin: 16px auto 10px;
      font-weight: bold;
      padding: 10px 0;
      border-radius: 40px;
      box-shadow: 0 5px 12px rgba(0,0,0,0.12);
      transition: 0.2s ease;
    }
    .back-btn:hover {
      background: #ffcc33;
      transform: translateY(-2px);
    }

    /* âœ… ä¸‹éƒ¨ãƒŠãƒ“ */
    .bottom-nav {
      position: fixed;
      left: 0;
      bottom: 0;
      width: 100%;
      background: #fff;
      border-top: 1px solid #ddd;
      display: flex;
      justify-content: space-around;
      align-items: center;
      height: 70px;
      box-shadow: 0 -2px 8px rgba(0,0,0,0.08);
      z-index: 1000;
    }
    .bottom-nav img {
      width: 50px;
      height: auto;
      display: block;
    }
    .bottom-nav a.active {
      transform: translateY(-2px);
    }
    /* âœ… ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆãƒ“ãƒ¥ãƒ¼ã‚’è¦‹æ¸¡ã—ã‚„ã™ãï¼ˆç¸¦ã®ä½™ç™½ã‚’åœ§ç¸®ï¼‰ */
header{
  padding: 12px 0;      /* 16px â†’ 12px */
  font-size: 20px;      /* 24px â†’ 20px */
  border-bottom-left-radius: 22px;
  border-bottom-right-radius: 22px;
}

.back-btn{
  width: 78%;
  max-width: 360px;
  margin: 12px auto 8px; /* 16px auto 10px â†’ åœ§ç¸® */
  padding: 10px 0;       /* ã¡ã‚‡ã„å°ã•ã */
  font-size: 16px;
  text-decoration: none; /* ä¸‹ç·šæ¶ˆã™ï¼ˆå¿µã®ãŸã‚ï¼‰ */
}

/* âœ… æ¤œç´¢æ¬„ï¼ˆãƒ«ãƒ¼ãƒ«ä¸€è¦§ãƒšãƒ¼ã‚¸ã®é›°å›²æ°—ï¼‰ */
#searchArea{
  width: 92%;
  max-width: 560px;
  margin: 8px auto 8px;
  text-align: center;
}

#searchInput{
  width: 100%;
  padding: 12px 14px;
  font-size: 16px;
  border: 1px solid rgba(0,0,0,0.12);
  border-radius: 999px;
  outline: none;
  background: #fff;
  box-shadow: 0 2px 10px rgba(0,0,0,0.06);
}

#search-results{
  width: 92%;
  max-width: 560px;
  margin: 8px auto 10px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.search-result-item{
  background:#fff;
  border:1px solid rgba(0,0,0,0.08);
  border-radius: 16px;
  padding: 12px 14px;
  font-size: 15px;
  font-weight: 700;
  box-shadow: 0 2px 10px rgba(0,0,0,0.06);
  cursor: pointer;
  display:flex;
  align-items:center;
  justify-content:space-between;
}
.search-result-item::after{
  content:"â€º";
  font-size: 24px;
  color: rgba(0,0,0,0.35);
}
.search-result-empty{
  text-align:center;
  color:#777;
  font-size:14px;
  margin: 4px 0 0;
}

/* âœ… è¦‹å‡ºã—ã®ä½™ç™½ã‚’åœ§ç¸®ï¼ˆè¦‹æ¸¡ã—ã‚„ã™ãï¼‰ */
.section-title{
  margin: 14px auto 6px; /* 22pxâ†’åœ§ç¸® */
}

/* âœ… ä¸€è¦§ã®ä½™ç™½ã‚‚å°‘ã—åœ§ç¸® */
#basicRulesList{
  padding: 10px 12px 18px;
  gap: 12px;
}
  </style>
</head>

<body>
  <header>
    <img src="syoshinsya.png"/>
    ã‚³ãƒ¼ã‚¹ãƒ‡ãƒ“ãƒ¥ãƒ¼ã€Œã„ã‚ã¯ã€ï¼ˆåŸºæœ¬ãƒ«ãƒ¼ãƒ«ï¼‰
  </header>

  <a href="index.html" class="back-btn">ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹</a>

  <!-- ğŸ” æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ï¼ˆåŸºæœ¬ãƒ«ãƒ¼ãƒ«å†…æ¤œç´¢ï¼‰ -->
<div id="searchArea">
  <input id="searchInput" type="text" placeholder="åŸºæœ¬ãƒ«ãƒ¼ãƒ«ã‚’æ¤œç´¢..." />
</div>

<!-- æ¤œç´¢çµæœï¼ˆä¸Šã«å‡ºã™ï¼‰ -->
<div id="search-results"></div>

  <main id="basicRulesList"></main>

  <nav class="bottom-nav">
    <a href="index.html">
      <img src="home-icon.png" alt="ãƒ›ãƒ¼ãƒ " />
    </a>

    <!-- 170ãƒ«ãƒ¼ãƒ«ä¸€è¦§ï¼ˆä»Šã¾ã§ã®ãƒ¡ã‚¤ãƒ³ï¼‰ -->
    <a href="rules.html">
      <img src="book-icon.png" alt="ãƒ«ãƒ¼ãƒ«ä¸€è¦§" />
    </a>

    <!-- ãŠæ°—ã«å…¥ã‚Š -->
    <a href="favorites.html">
      <img src="star-icon.png" alt="ãŠæ°—ã«å…¥ã‚Š" />
    </a>
  </nav>

  <script>
document.addEventListener("DOMContentLoaded", async () => {
  const listEl = document.getElementById("basicRulesList");
  const input = document.getElementById("searchInput");
  const results = document.getElementById("search-results");

  let rules = [];
  try {
    const res = await fetch("basic_rules.json");
    rules = await res.json();
  } catch (e) {
    console.warn("basic_rules.jsonã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:", e);
    listEl.innerHTML = `<p class="empty">åŸºæœ¬ãƒ«ãƒ¼ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</p>`;
    return;
  }

  // idé †
  rules.sort((a, b) => (a.id ?? 0) - (b.id ?? 0));

  // âœ… HTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
  const esc = (s) => String(s ?? "").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");

  // âœ… levelã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ã—ã¦è¡¨ç¤ºï¼ˆä»Šã®è¦‹å‡ºã—æ§‹æˆã‚’ç¶­æŒï¼‰
  const order = [];
  const grouped = {};
  rules.forEach(r => {
    const lv = r.level || "ãã®ä»–";
    if (!grouped[lv]) { grouped[lv] = []; order.push(lv); }
    grouped[lv].push(r);
  });

  const renderList = () => {
    if (!rules || rules.length === 0) {
      listEl.innerHTML = `<p class="empty">åŸºæœ¬ãƒ«ãƒ¼ãƒ«ãŒã¾ã ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>`;
      return;
    }

    listEl.innerHTML = order.map(lv => {
      const items = grouped[lv].map(r => {
        const title = esc(r.title);
        const id = Number(r.id);
        return `<a class="rule-item" href="basic_rule_detail.html?id=${id}"><span>${title}</span></a>`;
      }).join("");

      return `
        <div class="section-title">${esc(lv)}</div>
        ${items}
      `;
    }).join("");
  };

  renderList();

  // âœ… æ¤œç´¢ï¼ˆåŸºæœ¬ãƒ«ãƒ¼ãƒ«å†…ï¼‰
  if (input) {
    input.addEventListener("input", () => {
      const q = input.value.trim();
      if (!q) {
        results.innerHTML = "";
        return;
      }

      const hit = rules.filter(r =>
        (r.title && r.title.includes(q)) ||
        (r.description && r.description.includes(q)) ||
        (r.detail && r.detail.includes(q))
      ).slice(0, 12); // å¤šã™ãã‚‹ã¨è¦‹ã¥ã‚‰ã„ã®ã§ä¸Šé™

      results.innerHTML = hit.length
        ? hit.map(r => `
            <div class="search-result-item" onclick="location.href='basic_rule_detail.html?id=${Number(r.id)}'">
              ${esc(r.title)}
            </div>
          `).join("")
        : `<p class="search-result-empty">è©²å½“ã™ã‚‹é …ç›®ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>`;
    });
  }
});
</script>
</body>
</html>
